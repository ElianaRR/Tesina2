<html lang="ca">

<head>
    <title>Troba el lloc dels teus somnis pel teu casament</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Inserción archivo CSS leaflet en la cabecera y de overpass-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.css" />
    <link rel="stylesheet" href="OverPassLayer.css" />
    <!--Inserción archivo javascript leaflet y de overpass-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.js"></script>
    <script src="OverPassLayer.bundle.js"></script>

    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">
    <link rel="stylesheet" href="css/leaflet.awesome-markers.css">
    <script src="js/leaflet.awesome-markers.js"></script>

    <style>
        /*definició estil de mapa */
        #mapid { 
            height: 100%;
            width: 100%; }
    </style>
    <script>
        function init(){
        // inicialitzo el mapa del div mapid amb un zoom i centre determinats
            var mimapa = L.map("mapid",{
            center:[41.39776918360643, 2.1961095928327268],
            //zoom:9,
            zoom:24,
            //zoomControl: false,
            });
            var esri = L.tileLayer(
                'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                    maxZoom: 14,
                    minZoom: 1,
                    attribution: 'Tiles © Esri',
            }).addTo (mimapa);
            var osm= L.tileLayer(
                'http://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png',{
                //'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
                maxZoom : 14,
                minZoom : 1,
                attribution : 'OSM'
            }).addTo (mimapa); //vull afegir aquesta capa a la meva variable "mimapa"
            
            var baseMaps = {
                "Orto": esri
                
            };
            var overlayMaps = {
                "OSM": osm
            };
            controlCapas = L.control.layers(baseMaps, overlayMaps);
            controlCapas.addTo(mimapa);
 
            //Posición on he fet click: Aqui li estem dient que quan fem click al mapa executi una funció, i dins la funció rebem un paràmetre event que conté la posició a event.latlng
            mimapa.on('click', function(onMapClick) {       
                var popLocation= onMapClick.latlng;
                alert(popLocation);
                //Això pintaria el marcador al mapa
                var miPosicion = new L.circleMarker(popLocation).addTo(mimapa).bindPopup("Estàs aqui"); 
                       
                /*Aixo pintaria com un bocata al mapa allà on li indiques anteriorment
                var popup = L.popup()
                    .setLatLng(popLocation) //indiques on vols posar popup
                    .setContent('<p> Estàs aqui.</p>') //text que surt en el popup
                    .openOn(mimapa); //pinta el popup al meu mapa*/
                
            });
            
            controlEscala = L.control.scale({imperial:false});
            controlEscala.addTo(mimapa);   

            //busquem restaurants a un radi determinat
            var opl;
            if (mimapa.hasLayer(opl)) {mimapa.removeLayer(opl)}         
            
          /* opl = new L.OverPassLayer({
                debug: true,
                minZoom: 14,
                endPoint: 'https://overpass-api.de/api/',
               // query: node(around.popLocation:1000.0)["amenity"="restaurant"], out,
               query: node({around:1000.0,popLocation})["amenity"="restaurant"],out
             
            });
            mimapa.addLayer(opl);*/
        };

    
    </script>

</head>
<!--crido a la funció inicialitzar en el body-->
<body onLoad="init()">
    <div id="mapid"></div>
  
</body>